(function(e){"use strict";[HTMLCollection,NodeList].forEach(function(e){e.prototype.toArray=function(){return Array.prototype.slice.call(this)}});e.fn.easyTable=function(t,n){function l(){if(!s){i.removeChild(o);s=i.cloneNode(true);s.appendChild(o);s.removeChild(s.tBodies.item(0));s.id+="-fixed";s.style.width=i.offsetWidth+"px";i.parentNode.parentNode.insertBefore(s,i.parentNode);h()}}function c(){if(s){var e=u.toArray();for(var t in e){if(e.hasOwnProperty(t)){e[t].style.width=f[0].cells[t].style.width=""}}i.insertBefore(o,a);s.parentNode.removeChild(s)}}function h(){if(s){var e=f[0],t=e.cells,n=u.toArray(),r;for(var i in n){if(n.hasOwnProperty(i)){r=t[i].offsetWidth/a.offsetWidth*100+"%";n[i].style.width=r;f[0].cells[i].style.width=r}}}}function p(){if(r.beforeAdd){r.beforeAdd(e(i),undefined)}var t=document.createElement("tr"),n=r.contents||r.columnsValues,s=r.ids||r.columnsIDs,o=r.names||r.ColumnsNames,u;n.forEach(function(e,n){u=document.createElement("td");u.innerHTML=e;if(s&&s[n]){u.id=s[n]}if(o&&o[n]){u.setAttribute("name",o[n])}t.appendChild(u)});if(r.animateAdd){r.animateAdd(e(i),e(t))}a.appendChild(t);if(r.afterAdd){r.afterAdd(e(i),e(t))}}function d(){e.fn.easyTable.defaults.edit=!e.fn.easyTable.defaults.edit;if(e.fn.easyTable.defaults.edit){f.toArray().forEach(function(e){e.getElementsByTagName("td").toArray().forEach(function(e){e.ondblclick=v})})}else{f.toArray().forEach(function(e){e.getElementsByTagName("td").toArray().forEach(function(e){e.ondblclick=undefined})})}}function v(){var e=document.createElement("textarea");e.value=this.innerHTML;e.style.width=this.style.width+"px";e.style.height=this.style.height+"px";e.style.resize="none";e.onblur=m;this.innerHTML="";this.ondblclick=undefined;this.appendChild(e);h()}function m(){var e=this.parentNode;this.parentNode.removeChild(this);e.innerHTML=this.value;e.ondblclick=v;h()}function g(){if(r.beforeRemove){r.beforeRemove(e(i))}if(r.indexes){r.indexes.sort(function(e,t){return Number(e)-Number(t)}).reverse();r.indexes.forEach(function(e){a.deleteRow(e)})}if(r.afterRemove){r.afterRemove(e(i))}}function y(){if(r.beforeRemoveAll){r.beforeRemoveAll(e(i))}r.indexes=[];for(var t=0;t<f.length;t++){r.indexes.push(t)}g();if(r.afterRemoveAll){r.afterRemoveAll(e(i))}}function b(){if(r.column===0||r.column){var e=f.toArray().sort(function(e,t){var n=e.cells.item(r.column).innerHTML,i=t.cells.item(r.column).innerHTML;if(r.from){n=n.replace(r.from,r.to);i=i.replace(r.from,r.to)}return r.order==="asc"?w(n,i):w(i,n)}),t;while(t=f.toArray().shift()){a.removeChild(t)}while(t=e.shift()){a.appendChild(t)}}}function w(e,t){if(isNaN(e)||isNaN(t)){return e.localeCompare(t)}else{return Number(e)-Number(t)}}var r=e.extend({},e.fn.easyTable.defaults,n),i=this.get(0),s=document.getElementById(i.id+"-fixed"),o=i.tHead||s.tHead,u=o.rows.item(0).cells,a=i.tBodies.item(0),f=a.rows;switch(t){case"fixedHead":l();break;case"undoFixedHead":c();break;case"addRow":p();break;case"edit":case"editRowContent":d();break;case"removeRow":g();h();break;case"removeAllRows":y();h();break;case"sort":b();break}return this};e.fn.easyTable.defaults={indexes:null,content:null,names:null,ids:null,edit:false,column:null,from:null,to:"",order:"asc"}})(jQuery)
